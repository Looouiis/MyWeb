<template>
    <div class="update">
      <iframe src='https://my.spline.design/componentpencilscopy-659a8d290e9452a65ed61af67bdb62be/' frameborder='0' width='100%' height='100%'></iframe>
      <div class="updateForm">
        
        <form action="">
          <div class="title">Account</div>
          <div class="input-text">
            <a>username</a><input type="text" v-model="userForUpdate.username" placeholder="留空则不变"/>
          </div>
          <div class="input-text">
            <a>password</a><input type="password" v-model="userForUpdate.newPassword" placeholder="留空则不变"/>
          </div>
          <div class="gender">
            <div>
              <input type="radio" name="gender" v-model="userForUpdate.gender" value=false />
              <svg t="1671954436390" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2733" width="200" height="200"><path d="M624.375393 840.051501c-125.609813 88.36249-295.736515 73.492828-404.520103-35.303041-110.134353-110.173239-124.039038-281.673218-33.051767-407.788543 10.089799-13.980409 6.934946-33.493835-7.046486-43.586704-13.975293-10.097986-33.488719-6.947226-43.573401 7.048533-109.006669 151.087067-92.384084 356.522949 39.534412 488.481354 73.39459 73.411987 170.102143 111.098307 267.485077 111.098307 75.477019 0 151.36643-22.654976 217.07906-68.868507 14.103206-9.91993 17.496489-29.393447 7.579629-43.499723C657.945977 833.516668 638.4786 830.131571 624.375393 840.051501z" fill="#FFF" p-id="2734"></path><path d="M959.12648 89.744977c-0.183172-0.919952-0.527003-1.772366-0.788969-2.662643-0.311085-1.060145-0.555655-2.133593-0.981351-3.163039-0.441045-1.063215-1.043772-2.029216-1.594311-3.028986-0.428765-0.779759-0.769526-1.592264-1.2689-2.340301-2.288113-3.426029-5.229095-6.370081-8.654101-8.659217-0.765433-0.511653-1.595334-0.862647-2.39249-1.298576-0.983397-0.540306-1.930979-1.1328-2.974751-1.566682-1.038656-0.429789-2.122337-0.678452-3.192715-0.991584-0.881067-0.258896-1.722224-0.599657-2.632967-0.780783-2.910283-0.579191-5.872754-0.61296-8.819876-0.357134-0.862647-0.071631-1.691525-0.25992-2.572592-0.25992L700.929953 64.636113c-17.237593 0-31.212886 13.980409-31.212886 31.222095s13.975293 31.222095 31.212886 31.222095l152.250566 0L687.421288 292.8907c-132.484384-112.053052-329.144392-120.017444-469.979978-15.001669-13.818727 10.305717-16.673751 29.865191-6.371104 43.693128 10.292414 13.82282 29.841655 16.678868 43.679825 6.372128 124.557854-92.88448 301.497729-79.900771 411.56659 30.200836 109.875456 109.904109 122.988102 286.714024 30.491455 411.273924-10.282181 13.843286-7.396457 33.402761 6.441713 43.682895 5.593392 4.15667 12.121062 6.15928 18.588357 6.15928 9.540284 0 18.959817-4.355191 25.081235-12.603039 104.566544-140.816143 96.449679-337.313445-15.363919-469.626937L897.316739 171.232896l0 147.016355c0 17.242709 13.975293 31.222095 31.212886 31.222095s31.212886-13.980409 31.212886-31.222095L959.742511 95.859231C959.743534 93.809549 959.527616 91.762937 959.12648 89.744977z" fill="#FFF" p-id="2735"></path><path d="M397.125693 486.328317c7.985882 0 15.972786-3.049452 22.068621-9.142218l21.535479-21.536502c12.192693-12.19167 12.192693-31.958876 0.005117-44.155662-12.187577-12.196787-31.94455-12.19167-44.142359-0.005117l-21.535479 21.536502c-12.192693 12.19167-12.192693 31.958876-0.005117 44.155662C381.14779 483.279888 389.134695 486.328317 397.125693 486.328317z" fill="#FFF" p-id="2736"></path><path d="M591.455633 649.499607l21.535479-21.536502c12.192693-12.19167 12.192693-31.958876 0.005117-44.155662-12.187577-12.19167-31.94455-12.196787-44.142359-0.005117l-21.535479 21.536502c-12.192693 12.19167-12.192693 31.959899-0.005117 44.155662 6.096858 6.097882 14.08274 9.147334 22.073738 9.147334C577.372893 658.641825 585.358775 655.592372 591.455633 649.499607z" fill="#FFF" p-id="2737"></path><path d="M338.748121 569.379848c-4.831029 20.683065-4.673439 64.014966 26.544563 95.238085 22.769586 22.781866 52.184523 29.179576 74.446549 29.179576 8.102538 0 15.265682-0.848321 20.808932-2.062985 16.84055-3.694135 27.499307-20.342304 23.811312-37.183877-3.698229-16.845667-20.341281-27.517727-37.172621-23.818475-0.23843 0.051165-23.196305 4.293793-37.751812-10.269901-14.122649-14.122649-10.119475-35.700083-9.819646-37.199227 3.708462-16.683984-6.690376-33.286104-23.369244-37.183877C359.485421 542.156834 342.670453 552.59558 338.748121 569.379848z" fill="#FFF" p-id="2738"></path></svg>
            </div>
            <div>
              <input type="radio" name="gender" v-model="userForUpdate.gender" value=true />
              <svg t="1671954553791" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="905" width="200" height="200"><path d="M240.35776019 308.32219167c27.59260991-126.481339 141.74322503-218.27778775 271.4024813-218.27142752 129.65607616 0.00318012 243.79397143 91.78690903 271.40502442 218.23708576 3.2338816 14.82243463 17.87252206 24.2130918 32.69114079 20.97666709 14.82243401-3.24024121 24.21627192-17.87570217 20.97666711-32.69114079C803.75590221 145.07826402 667.04506762 35.12120216 511.76342099 35.12183794c-90.39541777-0.00317949-174.49478244 37.25609705-235.52133978 98.28265439-43.81162326 43.81162326-75.73515413 99.88528623-89.5514919 163.20386142-3.2338816 14.82243463 6.16059208 29.45725857 20.97666709 32.69114081C222.49223353 332.53591987 237.13341832 323.14144558 240.35776019 308.32219167z" fill="#FFF" p-id="906"></path><path d="M375.97537131 863.62195587l108.32517632-0.00127216 0 108.32644849c-0.00318012 15.16967136 12.29320137 27.46605285 27.46287336 27.46287336 15.16649187 0.00635961 27.46923297-12.29638149 27.46287337-27.46287336l0-108.32644849 108.33471604-0.00190733C662.72050564 863.61941216 675.02324736 851.32303066 675.02324736 836.15017918c0-15.16649125-12.29638149-27.46287274-27.46923297-27.46287274l-108.32835643 0.00190795 0-109.32236986C691.35228265 686.62973886 818.66482768 569.22425536 840.98974032 416.26451731c2.18771975-15.00877191-8.20267531-28.95166673-23.21462733-31.14256658-14.99923281-2.18453963-28.94212763 8.1931362-31.1425666 23.21462733-19.72763162 135.29517644-137.89945347 237.30076978-274.86976117 237.30458567-136.73627365-0.00254372-254.87311673-101.82943095-274.80044185-236.85495877-2.21252241-15.00813613-16.17513184-25.38008813-31.18008849-23.16438622-6.0658337 0.89416698-11.3729608 3.71085489-15.39734705 7.73524113-5.93609651 5.93609651-9.08793895 14.50635955-7.76640339 23.44548312 22.52587708 152.65193114 149.80280816 269.82973958 301.68140679 282.5617572l0 109.32364141-108.33153655 0.00127217c-7.5807019 0-14.44912306 3.07552648-19.41855254 8.04495596-4.9694301 4.9694301-8.04495596 11.83785065-8.04495597 19.42491278C348.50550256 851.32621016 360.80188468 863.62259227 375.97537131 863.62195587z" fill="#FFF" p-id="907"></path><path d="M424.47151187 360.58511006c4.9694301-4.9694301 8.04177648-11.83467115 8.04495597-19.41855254l0.00318013-26.79638207c0.00318012-15.16967136-12.29320137-27.46605285-27.46287275-27.46923297s-27.45969324 12.293202-27.46923297 27.46287273l-0.00318012 26.79638207c-0.00318012 15.16967136 12.29320137 27.46605285 27.46287274 27.46923296C412.63366123 368.63006602 419.49890228 365.55771966 424.47151187 360.58511006z" fill="#FFF" p-id="908"></path><path d="M646.8837072 341.16655752l0.00318012-26.79638207c0.00318012-15.16967136-12.29320137-27.46605285-27.46287274-27.46923298-15.16649125 0-27.46287336 12.29002188-27.46923297 27.46287274l-0.00318013 26.79638207c-0.00318012 15.16967136 12.29320137 27.46605285 27.46287275 27.46923296 7.58642512-0.00063577 14.45230318-3.07234638 19.42491278-8.04495596C643.80818133 355.61567996 646.88052771 348.75043891 646.8837072 341.16655752z" fill="#FFF" p-id="909"></path><path d="M439.8084423 448.56958531c9.85936414 15.87177598 36.91140405 42.72793888 75.75741309 42.72412361 28.33796089 0.00318012 50.62026357-14.31938588 64.4722159-28.1713382 5.04193016-5.04193016 8.970921-10.02662258 11.66423259-14.23098713 8.18041636-12.77717129 4.45684225-29.7644297-8.31396942-37.94484667-12.77971501-8.17787264-29.7548906-4.44094292-37.94484669 8.31396943-0.12019746 0.17743457-11.76535058 17.10109687-29.87763175 17.10109625-17.57234693 0.00317949-28.50267623-15.9092985-29.24929875-17.02859682-8.07039503-12.68495662-24.86750027-16.54144802-37.67011002-8.5887061C435.77515273 418.72883905 431.80800361 435.6874789 439.8084423 448.56958531z" fill="#FFF" p-id="910"></path></svg>
            </div>
          </div>
          <div class="input-text">
            <a>confirm</a><input type="password" v-model="userForUpdate.oriPassword" required placeholder="提供原密码“验明正身”"/>
          </div>
          <button class="btnUpdate" @click="send" type="button">提交</button>
        </form>

      </div>
    </div>
  </template>
<style lang="less">
.update{
  display: grid;
  grid-template-columns: 1fr 1fr;
  height: 95vh;
  iframe{
    height: 95vh;
  }
  .updateForm{
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .title{
    font-weight: bold;
    font-size: 2.2rem;
    margin-bottom: .5rem;
  }
}
form{
  z-index: 10;
  .input-text{
    input{
      background-color: rgba(255,255,255,0.8);
    }
  }
  svg{
    color: red;
  }
}

.btnUpdate{
  width: 150px;
  height: 49px;
  border: none;
  outline: none;
  border-radius: 25px;
  margin: 17px 0;
  cursor: pointer;
  background-color: #1ABBFE;
  font-size: 1.5rem;
  &:hover{
    background-color: #0AD182;
  }
}
.background.update-mode{
  &:before{
    content: '';
    width: 2000px;
    height: 2000px;
    transform: translate(100%, -75%);
    right: 52%;
    top: 95%;
    background: #0AD182;
  }
}
@media(max-width: 870px){
  iframe{
    display: none;
  }
  .background.update-mode{
    .updateForm{
      // left: 50%;
      width: 100%;
    }
    .update{
      display: flex;
      align-items: center;
      justify-content: center;
    }
    &:before{
      right: 150%;
      top: 100%;
    }
  }
}
</style>
<script>
export default {
  name: 'Update',
  props:{
    default: String,
    userId: Number
  },
  data(){
      return{
        con: '',
        userForUpdate:{
          id: 0,
          username: '',
          newPassword: '',
          oriPassword: '',
          gender: null
        }
      }
  },
  watch:{
    userId(lat,old){
      if(lat !== undefined && lat >=0 && lat !==null){
        this.userForUpdate.id = this.userId
      }
    }
  },
  created(){
    this.$emit('response', this.default + 'update-mode noMsg')
    if(this.userId !== undefined && this.userId >= 0 && this.userId !== null){
      this.userForUpdate.id = this.userId
    }
    else{
      // this.user.balabala = 7
      // console.log(this.user)
    }
  },
  methods:{
    send(){
      this.axios.patch(location.origin+'/users', this.userForUpdate).then((res) => {
        // if(this.userForUpdate.gender === null){
        //   this.$message.error("请设置性别")
        // }
        // else{
          if(res.data.status){
            this.$message.success(res.data.description)
          }
          else if('status' in res.data){
            this.$message.error(res.data.description)
          }
          else{
            this.$message.error(res.data.exceptionMessage)
          }
      // }
      })
    }
  }
}
</script>
  